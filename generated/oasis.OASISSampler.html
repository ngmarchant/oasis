
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>oasis.OASISSampler &#8212; OASIS v0.1.2-14-g25b9d06 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="oasis.ImportanceSampler" href="oasis.ImportanceSampler.html" />
    <link rel="prev" title="API Reference" href="../sections/api-ref.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="oasis-oasissampler">
<h1><code class="xref py py-mod docutils literal notranslate"><span class="pre">oasis</span></code>.OASISSampler<a class="headerlink" href="#oasis-oasissampler" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="oasis.OASISSampler">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">oasis.</span></span><span class="sig-name descname"><span class="pre">OASISSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oracle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proba</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior_strength</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decaying_prior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">record_inst_hist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">identifiers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#oasis.OASISSampler" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimal Asymptotic Sequential Importance Sampling (OASIS) for estimation
of the weighted F-measure.</p>
<p>Estimates the quantity:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>TP / (alpha * (TP + FP) + (1 - alpha) * (TP + FN))
</pre></div>
</div>
<p>on a finite pool by sampling items according to an adaptive instrumental
distribution that minimises asymptotic variance. See reference
<a class="reference internal" href="#r8815a4ad7d9d-marchant2017" id="id1">[Marchant2017]</a> for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>alpha</strong><span class="classifier">float</span></dt><dd><p>Weight for the F-measure. Valid weights are on the interval [0, 1].
<code class="docutils literal notranslate"><span class="pre">alpha</span> <span class="pre">==</span> <span class="pre">1</span></code> corresponds to precision, <code class="docutils literal notranslate"><span class="pre">alpha</span> <span class="pre">==</span> <span class="pre">0</span></code> corresponds to
recall, and <code class="docutils literal notranslate"><span class="pre">alpha</span> <span class="pre">==</span> <span class="pre">0.5</span></code> corresponds to the balanced F-measure.</p>
</dd>
<dt><strong>predictions</strong><span class="classifier">array-like, shape=(n_items,n_class)</span></dt><dd><p>Predicted labels for the items in the pool. Rows represent items and
columns represent different classifiers under evaluation (i.e. more
than one classifier may be evaluated in parallel). Valid labels are 0
or 1.</p>
</dd>
<dt><strong>scores</strong><span class="classifier">array-like, shape=(n_items,n_class)</span></dt><dd><p>Scores which quantify the confidence in the classifiers’ predictions.
Rows represent items and columns represent different classifiers under
evaluation. High scores indicate a high confidence that the true label
is 1 (and vice versa for label 0). It is recommended that the scores
be scaled to the interval [0,1]. If the scores lie outside [0,1] they
will be automatically re-scaled by applying the logisitic function.</p>
</dd>
<dt><strong>oracle</strong><span class="classifier">function</span></dt><dd><p>Function that returns ground truth labels for items in the pool. The
function should take an item identifier as input (i.e. its
corresponding row index) and return the ground truth label. Valid
labels are 0 or 1.</p>
</dd>
<dt><strong>proba</strong><span class="classifier">array-like, dtype=bool, shape=(n_class,), optional, default None</span></dt><dd><p>Indicates whether the scores are probabilistic, i.e. on the interval
[0, 1] for each classifier under evaluation. If proba is False for
a classifier, then the corresponding scores will be re-scaled by
applying the logistic function. If None, proba will default to
False for all classifiers.</p>
</dd>
<dt><strong>epsilon</strong><span class="classifier">float, optional, default 1e-3</span></dt><dd><p>Epsilon-greedy parameter. Valid values are on the interval [0, 1]. The
“asymptotically optimal” distribution is sampled from with probability
<cite>1 - epsilon</cite> and the passive distribution is sampled from with
probability <cite>epsilon</cite>. The sampling is close to “optimal” for small
epsilon.</p>
</dd>
<dt><strong>prior_strength</strong><span class="classifier">float, optional, default None</span></dt><dd><p>Quantifies the strength of the prior. May be interpreted as the number
of pseudo-observations.</p>
</dd>
<dt><strong>max_iter</strong><span class="classifier">int, optional, default None</span></dt><dd><p>Maximum number of iterations to expect for pre-allocating arrays.
Once this limit is reached, sampling can no longer continue. If no
value is given, defaults to n_items.</p>
</dd>
<dt><strong>strata</strong><span class="classifier">Strata instance, optional, default None</span></dt><dd><p>Describes how to stratify the pool. If not given, the stratification
will be done automatically based on the scores given. Additional
keyword arguments may be passed to control this automatic
stratification (see below).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Other Parameters</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>opt_class</strong><span class="classifier">array-like, dtype=bool, shape=(n_class,), optional, default None</span></dt><dd><p>Indicates which classifiers to use in calculating the optimal
distribution (and prior and strata). If opt_class is False for a
classifier, then its predictions and scores will not be used in
calculating the optimal distribution, however estimates of its
performance will still be calculated.</p>
</dd>
<dt><strong>decaying_prior</strong><span class="classifier">bool, optional, default True</span></dt><dd><p>Whether to make the prior strength decay as 1/n_k, where n_k is the
number of items sampled from stratum k at the current iteration. This
is a greedy strategy which may yield faster convergence of the estimate.</p>
</dd>
<dt><strong>record_inst_hist</strong><span class="classifier">bool, optional, default False</span></dt><dd><p>Whether to store the instrumental distribution used at each iteration.
This requires extra memory, but can be useful for assessing
convergence.</p>
</dd>
<dt><strong>identifiers</strong><span class="classifier">array-like, optional, default None</span></dt><dd><p>Unique identifiers for the items in the pool. Must match the row order
of the “predictions” parameter. If no value is given, defaults to
[0, 1, …, n_items].</p>
</dd>
<dt><strong>debug</strong><span class="classifier">bool, optional, default False</span></dt><dd><p>Whether to print out verbose debugging information.</p>
</dd>
<dt><strong>**kwargs :</strong></dt><dd><p>Optional keyword arguments. Includes ‘stratification_method’,
‘stratification_n_strata’, and ‘stratification_n_bins’.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="r8815a4ad7d9d-marchant2017"><span class="brackets"><a class="fn-backref" href="#id1">Marchant2017</a></span></dt>
<dd><p>N. G. Marchant and B. I. P. Rubinstein, In Search of an
Entity Resolution OASIS: Optimal Asymptotic Sequential Importance
Sampling, arXiv:1703.00617 [cs.LG], Mar 2017.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>estimate_</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>F-measure estimates for each iteration.</p>
</dd>
<dt><strong>queried_oracle_</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Records whether the oracle was queried at each iteration (True) or
whether a cached label was used (False).</p>
</dd>
<dt><strong>cached_labels_</strong><span class="classifier">numpy.ndarray, shape=(n_items,)</span></dt><dd><p>Previously sampled ground truth labels for the items in the pool. Items
which have not had their labels queried are recorded as NaNs. The order
of the items matches the row order for the “predictions” parameter.</p>
</dd>
<dt><strong>t_</strong><span class="classifier">int</span></dt><dd><p>Iteration index.</p>
</dd>
<dt><strong>inst_pmf_</strong><span class="classifier">numpy.ndarray, shape=(n_strata,) or (n_strata, max_iter)</span></dt><dd><p>Epsilon-greedy instrumental pmf used for sampling. If
<code class="docutils literal notranslate"><span class="pre">record_inst_hist</span> <span class="pre">==</span> <span class="pre">False</span></code> only the most recent pmf is returned,
otherwise returns the entire history of pmfs in a 2D array.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">reset</span></code>()</p></td>
<td><p>Resets the sampler to its initial state</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">sample</span></code>(n_to_sample, **kwargs)</p></td>
<td><p>Sample a sequence of items from the pool</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">sample_distinct</span></code>(n_to_sample, **kwargs)</p></td>
<td><p>Sample a sequence of items from the pool until a minimum number of distinct items are queried</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="oasis.OASISSampler.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oracle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proba</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior_strength</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decaying_prior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">record_inst_hist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">identifiers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#oasis.OASISSampler.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

</dd></dl>

<div class="clearer"></div></section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">OASIS</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=ngmarchant&repo=oasis&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../sections/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sections/oasis.html">OASIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sections/other-samplers.html">Other samplers</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../sections/api-ref.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../sections/api-ref.html#samplers-for-evaluation">Samplers for Evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sections/api-ref.html#stratification">Stratification</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/tutorial.html">Tutorial</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../sections/api-ref.html">API Reference</a><ul>
      <li>Previous: <a href="../sections/api-ref.html" title="previous chapter">API Reference</a></li>
      <li>Next: <a href="oasis.ImportanceSampler.html" title="next chapter"><code class="xref py py-mod docutils literal notranslate"><span class="pre">oasis</span></code>.ImportanceSampler</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Neil G. Marchant.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/generated/oasis.OASISSampler.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/ngmarchant/oasis" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>